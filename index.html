<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회수철 관리 기준 v3.1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap');
        body { font-family: 'Pretendard', sans-serif; letter-spacing: -0.02em; }
        .highlight { background-color: #fef08a; font-weight: 800; color: #1e40af; }
        
        /* 인쇄 전용 스타일 (PDF 및 A4 출력용) */
        @media print {
            header, .sticky, #emptyState, .view-btn, .cat-btn, button { display: none !important; }
            body { background-color: white !important; padding: 0 !important; }
            .max-w-\[1600px\] { max-width: 100% !important; margin: 0 !important; }
            #mainViewport { display: block !important; opacity: 1 !important; }
            
            /* 리스트 보기 강제 적용 및 레이아웃 최적화 */
            table { width: 100% !important; border-collapse: collapse !important; font-size: 10pt !important; }
            th, td { border: 1px solid #ddd !important; padding: 6px !important; }
            .color-dot { display: inline-block !important; width: 12px !important; height: 12px !important; border: 1px solid #000 !important; }
            tr { page-break-inside: avoid; }
            
            /* 제목 표시 */
            body::before {
                content: "회수철 분류 관리 기준 (Scrap Iron Classification)";
                display: block; font-size: 18pt; font-weight: bold; text-align: center; margin-bottom: 20px;
            }
        }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

    <div class="max-w-[1600px] mx-auto px-4 py-6">
        <header class="bg-white rounded-3xl p-6 shadow-sm border border-slate-200 mb-6 flex flex-col lg:flex-row justify-between items-center gap-6">
            <div class="flex items-center gap-4">
                <div class="w-12 h-12 bg-blue-700 rounded-2xl flex items-center justify-center text-white text-xl shadow-lg">
                    <i class="fas fa-print"></i>
                </div>
                <div>
                    <h1 class="text-2xl font-black text-slate-900">회수철 관리 시스템 v3.1</h1>
                    <p class="text-slate-500 text-sm">A4 인쇄 및 엑셀 출력 최적화 버전</p>
                </div>
            </div>
            <div class="flex gap-2">
                <button onclick="window.print()" class="bg-slate-800 hover:bg-black text-white px-5 py-3 rounded-2xl text-sm font-bold flex items-center gap-2 transition-all">
                    <i class="fas fa-file-pdf"></i> PDF/인쇄
                </button>
                <button onclick="exportToExcel()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-5 py-3 rounded-2xl text-sm font-bold flex items-center gap-2 shadow-lg shadow-emerald-100 transition-all">
                    <i class="fas fa-file-excel"></i> 엑셀 저장
                </button>
            </div>
        </header>

        <div class="sticky top-4 z-50 mb-8 no-print">
            <div class="bg-white/90 backdrop-blur-xl p-3 rounded-2xl shadow-xl border border-white/50 flex flex-col xl:flex-row gap-4">
                <div class="relative flex-1">
                    <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                    <input type="text" id="searchInput" oninput="handleSearch()"
                        class="w-full pl-11 pr-4 py-4 bg-slate-50 border-none rounded-xl focus:ring-2 focus:ring-blue-500 text-base font-semibold"
                        placeholder="강종 검색 시 인쇄물도 필터링됩니다...">
                </div>
            </div>
        </div>

        <div id="mainViewport" class="overflow-hidden bg-white rounded-[1.5rem] border border-slate-200 shadow-sm">
            <table class="w-full text-left border-collapse" id="printableTable">
                <thead>
                    <tr class="bg-slate-50 border-b border-slate-200">
                        <th class="px-6 py-4 text-xs font-black text-slate-500 uppercase w-[10%]">코드</th>
                        <th class="px-6 py-4 text-xs font-black text-slate-500 uppercase w-[15%]">마킹색상</th>
                        <th class="px-6 py-4 text-xs font-black text-slate-500 uppercase w-[15%]">그룹(비고)</th>
                        <th class="px-6 py-4 text-xs font-black text-slate-500 uppercase">포함 강종 목록</th>
                    </tr>
                </thead>
                <tbody id="tableBody" class="divide-y divide-slate-100">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        const data = [
            { id: 'P1', group: 'SC', colorName: '연녹색', colorHex: '#dcfce7', note: 'CARBON', materials: ['TW 694F70 M2', 'TW 266M GR.2 V', 'TW P1', 'TW S35C', 'TW S48C', 'TW S45SU', 'TWS355', 'TWS355Mn', 'TW 266M GR.2', 'TW SSW R-1', 'TW F1', 'TW B50 A517', 'S355NL', 'TW 694F70 M3', 'TW S25C', 'TW A668CL.E', 'EH36', 'TW 105', 'TW S44SY', 'TW B50A974A', 'TW 350LF2', 'TW 350LF2 MOD', 'SA266Gr2C', 'TW 350LF6', 'JB4726 20MnMo4', 'C-STEEL', 'TW S30Mn', 'TWVL E36', 'TW S30H', 'TW 694F70', 'TW 694F65 M6', 'A860WPHYF70', 'ASME SA765 GR.4', 'B50A517', 'TW 765GR4', 'TW 765Gr.4 M2', 'TW SF490AS1'] },
            { id: 'P1-1', group: 'SC', colorName: '살구색', colorHex: '#fff7ed', note: 'CARBON', materials: ['TW S360', 'TW SF490', 'TW SF490V', 'TW SF490V M1', 'TW SF590', 'TW SF590M1', 'TW SF590S'] },
            { id: 'P2', group: 'SCM', colorName: '황색', colorHex: '#fef9c3', note: 'CARBON / Low Alloy', materials: ['TW F22', 'TW SCM430', 'TW42CrMo4 M', 'TW SCM440', 'TW K11B64A', 'SFCM880', 'TW F11 Modi', 'TW 4130 M2', 'TWCrMo825', 'SCM440', 'ASME SA336 GR.F12 MOD1', 'TW 4140', 'TW S17MoS', 'TW SCM435', '42CrMo4', 'TW F1', 'TW SFCM830', 'TW 4130 M5'] },
            { id: 'P2-1', group: 'SNCM', colorName: '은색', colorHex: '#e2e8f0', note: 'ALLOY', materials: ['SNCM439', 'SNCM431M', 'TW 4340 M1', '34CrNiMo6', 'TW 508Gr4N', 'TW 18CrNiMo7-6', 'SKT4', 'TW P4', 'WSTE 460'] },
            { id: 'P3', group: 'STS 304', colorName: '적색', colorHex: '#fee2e2', note: 'Stainless Steel', materials: ['TW F304L', 'TW F304H', 'TW F321H', 'TW F347H'] },
            { id: 'P4', group: 'STS 316', colorName: '주황', colorHex: '#ffedd5', note: 'Stainless Steel', materials: ['TW F316L', 'TW F316L P', 'TW F317L', 'TW F316 Ti'] },
            { id: 'P5', group: 'STS 400', colorName: '분홍', colorHex: '#fce7f3', note: 'Stainless Steel', materials: ['TW F6a', 'TW F9', 'TW F5', 'TW F91', 'TW X11 CrMo12-1'] },
            { id: 'P6', group: 'SKD', colorName: '연청', colorHex: '#e0f2fe', note: 'Tool Steel', materials: ['TW SKD61', 'TW F22V'] },
            { id: 'P7', group: 'SKH', colorName: '검정', colorHex: '#1e293b', note: 'Tool Steel', materials: ['TW F92'] },
            { id: 'P8', group: 'STS Cu', colorName: '백색', colorHex: '#ffffff', note: 'Special STS', materials: ['TW 17-4', 'SUS630', 'TW 06X12H3Д'] },
            { id: 'P9', group: 'STS Dual', colorName: '아이보리', colorHex: '#fffbeb', note: 'Special STS', materials: ['TW F51', 'TW F53'] }
        ];

        let currentSearch = '';

        function handleSearch() {
            currentSearch = document.getElementById('searchInput').value.toUpperCase();
            render();
        }

        function render() {
            const body = document.getElementById('tableBody');
            const filtered = data.filter(g => g.id.includes(currentSearch) || g.materials.some(m => m.toUpperCase().includes(currentSearch)));

            body.innerHTML = filtered.map(g => `
                <tr class="group">
                    <td class="px-6 py-4 font-black text-slate-900">${g.id}</td>
                    <td class="px-6 py-4">
                        <div class="flex items-center gap-2">
                            <div class="color-dot w-4 h-4 rounded-full border border-slate-200" style="background-color: ${g.colorHex}"></div>
                            <span class="text-sm font-bold">${g.colorName}</span>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="text-xs font-bold text-slate-500 block">${g.group}</span>
                        <span class="text-[10px] text-slate-400">${g.note}</span>
                    </td>
                    <td class="px-6 py-4">
                        <p class="text-[11px] leading-relaxed text-slate-600 font-medium">
                            ${g.materials.map(m => currentSearch && m.toUpperCase().includes(currentSearch) ? `<mark class="highlight">${m}</mark>` : m).join(', ')}
                        </p>
                    </td>
                </tr>
            `).join('');
        }

        function exportToExcel() {
            const table = document.getElementById('printableTable');
            const wb = XLSX.utils.table_to_book(table, { sheet: "회수철기준" });
            
            // 엑셀 인쇄 설정 보정 (모든 열을 한 페이지에 맞춤)
            if(!wb.Sheets["회수철기준"]["!printOptions"]) wb.Sheets["회수철기준"]["!printOptions"] = {};
            wb.Sheets["회수철기준"]["!margins"] = {left:0.7, right:0.7, top:0.75, bottom:0.75, header:0.3, footer:0.3};
            
            XLSX.writeFile(wb, "회수철_분류_기준표.xlsx");
        }

        render();
    </script>
</body>
</html>
